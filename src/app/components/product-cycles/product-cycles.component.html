<div class="data-table">
  <mat-toolbar color="accent" class="table-title">
    <div>{{ productMapping?.['name'] || product[0].toUpperCase() + product.substring(1) }}</div>
    <div><button mat-icon-button (click)="removeProduct()"><mat-icon>close</mat-icon></button></div>
  </mat-toolbar>
  <mat-table [dataSource]="productDataSource" class="mat-elevation-z8">
    <ng-container matColumnDef="cycle-cycle">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-cycle']?.['header'] || 'Release' }}</th>
      <td mat-cell *matCellDef="let cycle">{{cycle.cycle}}{{cycle.codename ? ' (' + cycle.codename + ')' : '' }}</td>
    </ng-container>

    <ng-container matColumnDef="cycle-release-date">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-release-date']?.['header'] || 'Released' }}</th>
      <td mat-cell *matCellDef="let cycle">{{formatTimeAgo(cycle.releaseDate)}}</td>
    </ng-container>

    <ng-container matColumnDef="cycle-eol">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-eol']?.['header'] || 'Security Support' }}</th>
      <td mat-cell *matCellDef="let cycle" [class]="resolveDateClass(cycle.eol)">{{formatTimeAgo(cycle.eol, true)}}</td>
    </ng-container>

    <ng-container matColumnDef="cycle-latest">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-latest']?.['header'] || 'Latest' }}</th>
      <td mat-cell *matCellDef="let cycle">
        {{cycle.latest}}
        @if (cycle.latestReleaseDate) {
          ({{formatDateOrBoolean(cycle.latestReleaseDate)}})
        }
      </td>
    </ng-container>

    <ng-container matColumnDef="cycle-link">
      <th mat-header-cell *matHeaderCellDef>URL</th>
      <td mat-cell *matCellDef="let cycle">{{cycle.link}}</td>
    </ng-container>

    <ng-container matColumnDef="cycle-support">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-support']?.['header'] || 'Support' }}</th>
      <td mat-cell *matCellDef="let cycle" [class]="resolveDateClass(cycle.support)">{{formatTimeAgo(cycle.support, true)}}</td>
    </ng-container>

    <ng-container matColumnDef="cycle-lts">
      <th mat-header-cell *matHeaderCellDef>LTS</th>
      <td mat-cell *matCellDef="let cycle" [class]="resolveDateClass(cycle.lts)">{{formatTimeAgo(cycle.lts, true) || ''}}</td>
    </ng-container>

    <ng-container matColumnDef="cycle-extended-support">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-extended-support']?.['header'] || 'Extended Support' }}</th>
      @if (productMapping) {
        <td mat-cell
            *matCellDef="let cycle"
            [class]="
            resolveDateClass(cycle.extendedSupport,
              productMapping['columns']['cycle-extended-support']?.['unavailable'],
              productMapping['columns']['cycle-extended-support']?.['invert'])
          "
        >
          {{formatTimeAgo(cycle.extendedSupport,
          true,
          productMapping['columns']['cycle-extended-support']?.['unavailable'],
          productMapping['columns']['cycle-extended-support']?.['invert']) || ''
          }}
        </td>
      } @else {
        <td mat-cell *matCellDef="let cycle" [class]="resolveDateClass(cycle.extendedSupport)">{{formatTimeAgo(cycle.extendedSupport, true)}}</td>
      }
    </ng-container>

    <ng-container matColumnDef="cycle-supported-java-versions">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-supported-java-versions']?.['header'] || 'Supported Java' }}</th>
      <td mat-cell *matCellDef="let cycle">{{cycle.supportedJavaVersions}}</td>
    </ng-container>

    <ng-container matColumnDef="cycle-supported-jakarta-ee-versions">
      <th mat-header-cell *matHeaderCellDef>{{ productMapping?.['columns']?.['cycle-supported-jakarta-ee-versions']?.['header'] ?? 'Supported Jakarta' }}</th>
      <td mat-cell *matCellDef="let cycle">{{cycle.supportedJakartaEEVersions}}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="columnDefs; sticky: true"></tr>
    <tr mat-row *matRowDef="let row; columns: columnDefs"></tr>
  </mat-table>
</div>
<br />
